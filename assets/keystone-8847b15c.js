import{_ as hr}from"./capstone-0248372e.js";var mr=(()=>{var L=import.meta.url;return async function(R={}){var n=R,M,K;n.ready=new Promise((t,r)=>{M=t,K=r});var h=Object.assign({},n),m="./this.program",P=(t,r)=>{throw r},N=typeof window=="object",I=typeof importScripts=="function",U=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",u="";function pt(t){return n.locateFile?n.locateFile(t,u):u+t}var j,H,k;if(U){const{createRequire:t}=await hr(()=>import("module"),[]);var W=t(import.meta.url),tt=W("fs"),z=W("path");I?u=z.dirname(u)+"/":u=W("url").fileURLToPath(new URL("/assets/index-f1102581.mjs",self.location)),j=(r,e)=>(r=X(r)?new URL(r):z.normalize(r),tt.readFileSync(r,e?void 0:"utf8")),k=r=>{var e=j(r,!0);return e.buffer||(e=new Uint8Array(e)),e},H=(r,e,_,s=!0)=>{r=X(r)?new URL(r):z.normalize(r),tt.readFile(r,s?void 0:"utf8",(o,i)=>{o?_(o):e(s?i.buffer:i)})},!n.thisProgram&&process.argv.length>1&&(m=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),P=(r,e)=>{throw process.exitCode=r,e},n.inspect=()=>"[Emscripten Module object]"}else(N||I)&&(I?u=self.location.href:typeof document<"u"&&document.currentScript&&(u=document.currentScript.src),L&&(u=L),u.indexOf("blob:")!==0?u=u.substr(0,u.replace(/[?#].*/,"").lastIndexOf("/")+1):u="",j=t=>{var r=new XMLHttpRequest;return r.open("GET",t,!1),r.send(null),r.responseText},I&&(k=t=>{var r=new XMLHttpRequest;return r.open("GET",t,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),H=(t,r,e)=>{var _=new XMLHttpRequest;_.open("GET",t,!0),_.responseType="arraybuffer",_.onload=()=>{if(_.status==200||_.status==0&&_.response){r(_.response);return}e()},_.onerror=e,_.send(null)});var Ot=n.print||console.log.bind(console),C=n.printErr||console.error.bind(console);Object.assign(n,h),h=null,n.arguments&&n.arguments,n.thisProgram&&(m=n.thisProgram),n.quit&&(P=n.quit);var g;n.wasmBinary&&(g=n.wasmBinary);var dt=n.noExitRuntime||!0;typeof WebAssembly!="object"&&b("no native wasm support detected");var rt,$=!1,l,D,q,et,E,nt,B,_t;function ht(){var t=rt.buffer;n.HEAP8=l=new Int8Array(t),n.HEAP16=q=new Int16Array(t),n.HEAPU8=D=new Uint8Array(t),n.HEAPU16=new Uint16Array(t),n.HEAP32=et=new Int32Array(t),n.HEAPU32=E=new Uint32Array(t),n.HEAPF32=nt=new Float32Array(t),n.HEAPF64=_t=new Float64Array(t),n.HEAP64=B=new BigInt64Array(t),n.HEAPU64=new BigUint64Array(t)}var st=[],ot=[],it=[],mt=0;function Nt(){return dt||mt>0}function Ct(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)gt(n.preRun.shift());x(st)}function Dt(){x(ot)}function Pt(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)bt(n.postRun.shift());x(it)}function gt(t){st.unshift(t)}function yt(t){ot.unshift(t)}function bt(t){it.unshift(t)}var T=0,y=null;function wt(t){T++,n.monitorRunDependencies&&n.monitorRunDependencies(T)}function Vt(t){if(T--,n.monitorRunDependencies&&n.monitorRunDependencies(T),T==0&&y){var r=y;y=null,r()}}function b(t){n.onAbort&&n.onAbort(t),t="Aborted("+t+")",C(t),$=!0,t+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(t);throw K(r),r}var Lt="data:application/octet-stream;base64,";function at(t){return t.startsWith(Lt)}function X(t){return t.startsWith("file://")}var v;n.locateFile?(v="keystone.wasm",at(v)||(v=pt(v))):v=new URL("/assets/keystone-cd19c262.wasm",self.location).href;function Rt(t){if(t==v&&g)return new Uint8Array(g);if(k)return k(t);throw"both async and sync fetching of the wasm failed"}function Ut(t){if(!g&&(N||I)){if(typeof fetch=="function"&&!X(t))return fetch(t,{credentials:"same-origin"}).then(r=>{if(!r.ok)throw"failed to load wasm binary file at '"+t+"'";return r.arrayBuffer()}).catch(()=>Rt(t));if(H)return new Promise((r,e)=>{H(t,_=>r(new Uint8Array(_)),e)})}return Promise.resolve().then(()=>Rt(t))}function St(t,r,e){return Ut(t).then(_=>WebAssembly.instantiate(_,r)).then(_=>_).then(e,_=>{C(`failed to asynchronously prepare wasm: ${_}`),b(_)})}function Ht(t,r,e,_){return!t&&typeof WebAssembly.instantiateStreaming=="function"&&!at(r)&&!X(r)&&!U&&typeof fetch=="function"?fetch(r,{credentials:"same-origin"}).then(s=>{var o=WebAssembly.instantiateStreaming(s,e);return o.then(_,function(i){return C(`wasm streaming compile failed: ${i}`),C("falling back to ArrayBuffer instantiation"),St(r,e,_)})}):St(r,e,_)}function kt(){var t={a:Or};function r(_,s){return S=_.exports,rt=S.v,ht(),yt(S.w),Vt(),S}wt();function e(_){r(_.instance)}if(n.instantiateWasm)try{return n.instantiateWasm(t,r)}catch(_){C(`Module.instantiateWasm callback failed with error: ${_}`),K(_)}return Ht(g,v,t,e).catch(K),{}}function Bt(t){this.name="ExitStatus",this.message=`Program terminated with exit(${t})`,this.status=t}var x=t=>{for(;t.length>0;)t.shift()(n)};function Xt(t,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":return l[t>>0];case"i8":return l[t>>0];case"i16":return q[t>>1];case"i32":return et[t>>2];case"i64":return B[t>>3];case"float":return nt[t>>2];case"double":return _t[t>>3];case"*":return E[t>>2];default:b(`invalid type for getValue: ${r}`)}}function Ft(t){this.excPtr=t,this.ptr=t-24,this.set_type=function(r){E[this.ptr+4>>2]=r},this.get_type=function(){return E[this.ptr+4>>2]},this.set_destructor=function(r){E[this.ptr+8>>2]=r},this.get_destructor=function(){return E[this.ptr+8>>2]},this.set_caught=function(r){r=r?1:0,l[this.ptr+12>>0]=r},this.get_caught=function(){return l[this.ptr+12>>0]!=0},this.set_rethrown=function(r){r=r?1:0,l[this.ptr+13>>0]=r},this.get_rethrown=function(){return l[this.ptr+13>>0]!=0},this.init=function(r,e){this.set_adjusted_ptr(0),this.set_type(r),this.set_destructor(e)},this.set_adjusted_ptr=function(r){E[this.ptr+16>>2]=r},this.get_adjusted_ptr=function(){return E[this.ptr+16>>2]},this.get_exception_ptr=function(){var r=It(this.get_type());if(r)return E[this.excPtr>>2];var e=this.get_adjusted_ptr();return e!==0?e:this.excPtr}}var ct=0,Yt=(t,r,e)=>{var _=new Ft(t);throw _.init(r,e),ct=t,ct},Et=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,ut=(t,r,e)=>{for(var _=r+e,s=r;t[s]&&!(s>=_);)++s;if(s-r>16&&t.buffer&&Et)return Et.decode(t.subarray(r,s));for(var o="";r<s;){var i=t[r++];if(!(i&128)){o+=String.fromCharCode(i);continue}var a=t[r++]&63;if((i&224)==192){o+=String.fromCharCode((i&31)<<6|a);continue}var A=t[r++]&63;if((i&240)==224?i=(i&15)<<12|a<<6|A:i=(i&7)<<18|a<<12|A<<6|t[r++]&63,i<65536)o+=String.fromCharCode(i);else{var p=i-65536;o+=String.fromCharCode(55296|p>>10,56320|p&1023)}}return o},ft=(t,r)=>t?ut(D,t,r):"",Gt=(t,r)=>{},jt=t=>{for(var r=0,e=0;e<t.length;++e){var _=t.charCodeAt(e);_<=127?r++:_<=2047?r+=2:_>=55296&&_<=57343?(r+=4,++e):r+=3}return r},Wt=(t,r,e,_)=>{if(!(_>0))return 0;for(var s=e,o=e+_-1,i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a>=55296&&a<=57343){var A=t.charCodeAt(++i);a=65536+((a&1023)<<10)|A&1023}if(a<=127){if(e>=o)break;r[e++]=a}else if(a<=2047){if(e+1>=o)break;r[e++]=192|a>>6,r[e++]=128|a&63}else if(a<=65535){if(e+2>=o)break;r[e++]=224|a>>12,r[e++]=128|a>>6&63,r[e++]=128|a&63}else{if(e+3>=o)break;r[e++]=240|a>>18,r[e++]=128|a>>12&63,r[e++]=128|a>>6&63,r[e++]=128|a&63}}return r[e]=0,e-s},zt=(t,r,e)=>Wt(t,D,r,e),$t=(t,r)=>{},qt=(t,r)=>{},xt=(t,r,e,_)=>{};function Qt(t,r,e,_){}var Jt=(t,r)=>{};function Zt(t,r,e,_,s,o,i){return-52}function tr(t,r,e,_,s,o){}var rr=()=>{b("")},er=(t,r,e)=>D.copyWithin(t,r,r+e),nr=t=>{b("OOM")},_r=t=>{D.length,nr()},Q={},sr=()=>m||"./this.program",w=()=>{if(!w.strings){var t=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:t,_:sr()};for(var e in Q)Q[e]===void 0?delete r[e]:r[e]=Q[e];var _=[];for(var e in r)_.push(`${e}=${r[e]}`);w.strings=_}return w.strings},or=(t,r)=>{for(var e=0;e<t.length;++e)l[r++>>0]=t.charCodeAt(e);l[r>>0]=0},ir=(t,r)=>{var e=0;return w().forEach((_,s)=>{var o=r+e;E[t+s*4>>2]=o,or(_,o),e+=_.length+1}),0},ar=(t,r)=>{var e=w();E[t>>2]=e.length;var _=0;return e.forEach(s=>_+=s.length+1),E[r>>2]=_,0},Rr=t=>{Nt()||(n.onExit&&n.onExit(t),$=!0),P(t,new Bt(t))},Sr=(t,r)=>{Rr(t)},cr=Sr,Er=t=>52,ur=(t,r)=>{var e=0,_=0,s=0;{var o=2;t==0?e=2:(t==1||t==2)&&(e=64),s=1}return l[r>>0]=o,q[r+2>>1]=s,B[r+8>>3]=BigInt(e),B[r+16>>3]=BigInt(_),0};function fr(t,r,e,_,s){return 52}var Ar=(t,r,e,_)=>52;function lr(t,r,e,_){return 70}var Mr=[null,[],[]],Kr=(t,r)=>{var e=Mr[t];r===0||r===10?((t===1?Ot:C)(ut(e,0)),e.length=0):e.push(r)},Ir=(t,r,e,_)=>{for(var s=0,o=0;o<e;o++){var i=E[r>>2],a=E[r+4>>2];r+=8;for(var A=0;A<a;A++)Kr(t,D[i+A]);s+=a}return E[_>>2]=s,0},At=t=>{var r=n["_"+t];return r},Tr=(t,r)=>{l.set(t,r)},vr=t=>{var r=jt(t)+1,e=J(r);return zt(t,e,r),e},lt=(t,r,e,_,s)=>{var o={string:f=>{var V=0;return f!=null&&f!==0&&(V=vr(f)),V},array:f=>{var V=J(f.length);return Tr(f,V),V}};function i(f){return r==="string"?ft(f):r==="boolean"?!!f:f}var a=At(t),A=[],p=0;if(_)for(var O=0;O<_.length;O++){var vt=o[e[O]];vt?(p===0&&(p=Mt()),A[O]=vt(_[O])):A[O]=_[O]}var Z=a.apply(null,A);function dr(f){return p!==0&&Kt(p),i(f)}return Z=dr(Z),Z},pr=(t,r,e,_)=>{var s=!e||e.every(i=>i==="number"||i==="boolean"),o=r!=="string";return o&&s&&!_?At(t):function(){return lt(t,r,e,arguments)}},Or={b:Yt,c:Gt,o:$t,r:qt,s:xt,p:Qt,t:Jt,k:Zt,l:tr,a:rr,j:er,u:_r,m:ir,n:ar,h:cr,g:Er,e:ur,i:fr,q:Ar,d:lr,f:Ir},S=kt();n._ks_version=(t,r)=>(n._ks_version=S.x)(t,r),n._ks_errno=t=>(n._ks_errno=S.y)(t),n._ks_strerror=t=>(n._ks_strerror=S.z)(t),n._ks_arch_supported=t=>(n._ks_arch_supported=S.A)(t),n._ks_open=(t,r,e)=>(n._ks_open=S.B)(t,r,e),n._ks_close=t=>(n._ks_close=S.C)(t),n._ks_option=(t,r,e)=>(n._ks_option=S.D)(t,r,e),n._ks_free=t=>(n._ks_free=S.E)(t),n._ks_asm=(t,r,e,_,s,o)=>(n._ks_asm=S.F)(t,r,e,_,s,o),n._malloc=t=>(n._malloc=S.G)(t),n._free=t=>(n._free=S.H)(t);var Mt=()=>(Mt=S.I)(),Kt=t=>(Kt=S.J)(t),J=t=>(J=S.K)(t),It=t=>(It=S.L)(t);n.ccall=lt,n.cwrap=pr,n.getValue=Xt,n.UTF8ToString=ft;var F;y=function t(){F||Tt(),F||(y=t)};function Tt(){if(T>0||(Ct(),T>0))return;function t(){F||(F=!0,n.calledRun=!0,!$&&(Dt(),M(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),Pt()))}n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),t()},1)):t()}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return Tt(),R.ready}})();const Nr=0,Cr=9,Dr=0,Pr=9,gr=2,yr=1,br=2,wr=3,Vr=4,Lr=5,Ur=6,Hr=7,kr=8,Br=9,Xr=10,Fr=0,Yr=1073741824,Gr=1,jr=16,Wr=64,zr=16,$r=32,qr=64,xr=4,Qr=8,Jr=2,Zr=4,te=8,re=4,ee=8,ne=16,_e=4,se=8,oe=16,ie=128,ae=512,G=0,Re=1,Se=2,ce=3,Ee=4,ue=5,fe=6,Ae=128,le=129,Me=130,Ke=131,Ie=132,Te=133,ve=134,pe=135,Oe=136,de=137,he=138,me=139,Ne=140,Ce=141,De=142,Pe=143,ge=144,ye=145,be=146,we=147,Ve=148,Le=149,Ue=150,He=151,ke=152,Be=153,Xe=154,Fe=155,Ye=156,Ge=157,je=158,We=159,ze=160,$e=161,qe=162,xe=163,Qe=512,Je=513,Ze=514,tn=1,rn=2,en=1,nn=2,_n=4,sn=8,on=16,an=32;var cn=Object.freeze({__proto__:null,KS_API_MAJOR:Nr,KS_API_MINOR:Cr,KS_ARCH_ARM:yr,KS_ARCH_ARM64:br,KS_ARCH_EVM:Br,KS_ARCH_HEXAGON:kr,KS_ARCH_MAX:Xr,KS_ARCH_MIPS:wr,KS_ARCH_PPC:Lr,KS_ARCH_SPARC:Ur,KS_ARCH_SYSTEMZ:Hr,KS_ARCH_X86:Vr,KS_ERR_ARCH:Se,KS_ERR_ASM:ie,KS_ERR_ASM_ARCH:ae,KS_ERR_ASM_DIRECTIVE_COMMA:Te,KS_ERR_ASM_DIRECTIVE_EQU:he,KS_ERR_ASM_DIRECTIVE_FPOINT:Oe,KS_ERR_ASM_DIRECTIVE_ID:Me,KS_ERR_ASM_DIRECTIVE_INVALID:me,KS_ERR_ASM_DIRECTIVE_RELOC_NAME:ve,KS_ERR_ASM_DIRECTIVE_RELOC_TOKEN:pe,KS_ERR_ASM_DIRECTIVE_STR:Ie,KS_ERR_ASM_DIRECTIVE_TOKEN:Ke,KS_ERR_ASM_DIRECTIVE_UNKNOWN:de,KS_ERR_ASM_DIRECTIVE_VALUE_RANGE:le,KS_ERR_ASM_ESC_BACKSLASH:Fe,KS_ERR_ASM_ESC_OCTAL:Ye,KS_ERR_ASM_ESC_SEQUENCE:Ge,KS_ERR_ASM_ESC_STR:je,KS_ERR_ASM_EXPR_BRACKET:Ce,KS_ERR_ASM_EXPR_TOKEN:Ae,KS_ERR_ASM_FIXUP_INVALID:$e,KS_ERR_ASM_FRAGMENT_INVALID:xe,KS_ERR_ASM_INSN_UNSUPPORTED:ze,KS_ERR_ASM_INVALIDOPERAND:Qe,KS_ERR_ASM_LABEL_INVALID:qe,KS_ERR_ASM_MACRO_ARGS:He,KS_ERR_ASM_MACRO_EQU:Ue,KS_ERR_ASM_MACRO_INVALID:Xe,KS_ERR_ASM_MACRO_LEVELS_EXCEED:ke,KS_ERR_ASM_MACRO_PAREN:Le,KS_ERR_ASM_MACRO_STR:Be,KS_ERR_ASM_MACRO_TOKEN:Ve,KS_ERR_ASM_MISSINGFEATURE:Je,KS_ERR_ASM_MNEMONICFAIL:Ze,KS_ERR_ASM_RPAREN:ye,KS_ERR_ASM_STAT_TOKEN:be,KS_ERR_ASM_SYMBOL_MISSING:ge,KS_ERR_ASM_SYMBOL_MODIFIER:De,KS_ERR_ASM_SYMBOL_REDEFINED:Pe,KS_ERR_ASM_TOKEN_INVALID:We,KS_ERR_ASM_UNSUPPORTED:we,KS_ERR_ASM_VARIANT_INVALID:Ne,KS_ERR_HANDLE:ce,KS_ERR_MODE:Ee,KS_ERR_NOMEM:Re,KS_ERR_OK:G,KS_ERR_OPT_INVALID:fe,KS_ERR_VERSION:ue,KS_MODE_16:Jr,KS_MODE_32:Zr,KS_MODE_64:te,KS_MODE_ARM:Gr,KS_MODE_BIG_ENDIAN:Yr,KS_MODE_LITTLE_ENDIAN:Fr,KS_MODE_MICRO:zr,KS_MODE_MIPS3:$r,KS_MODE_MIPS32:xr,KS_MODE_MIPS32R6:qr,KS_MODE_MIPS64:Qr,KS_MODE_PPC32:re,KS_MODE_PPC64:ee,KS_MODE_QPX:ne,KS_MODE_SPARC32:_e,KS_MODE_SPARC64:se,KS_MODE_THUMB:jr,KS_MODE_V8:Wr,KS_MODE_V9:oe,KS_OPT_SYM_RESOLVER:rn,KS_OPT_SYNTAX:tn,KS_OPT_SYNTAX_ATT:nn,KS_OPT_SYNTAX_GAS:on,KS_OPT_SYNTAX_INTEL:en,KS_OPT_SYNTAX_MASM:sn,KS_OPT_SYNTAX_NASM:_n,KS_OPT_SYNTAX_RADIX16:an,KS_VERSION_EXTRA:gr,KS_VERSION_MAJOR:Dr,KS_VERSION_MINOR:Pr});const Y=4;const Rn={ks_open:{returnType:"number",argTypes:["number","number","number"]},ks_asm:{returnType:"number",argTypes:["number","string","number","number","number","number"]},ks_free:{returnType:null,argTypes:["number"]},ks_close:{returnType:"number",argTypes:["number"]},ks_option:{returnType:"number",argTypes:["number","number","number"]},ks_errno:{returnType:"number",argTypes:["number"]},ks_version:{returnType:"number",argTypes:["number","number"]},ks_arch_supported:{returnType:"boolean",argTypes:["number"]},ks_strerror:{returnType:"string",argTypes:["number"]},malloc:{returnType:"number",argTypes:["number"]},free:{returnType:null,argTypes:["number"]}};let d;class c{get handle(){return d.getValue(this.handle_ptr,"*")}setOption(R,n){return c.call("ks_option",this.handle,R,n)}close(){const R=c.call("ks_close",this.handle);if(R!==G)throw new Error(`Failed to close keystone: ${c.strError(R)}`);this.handle_ptr=null}asm(R,n={}){const{address:M=0}=n,K=c.call("malloc",Y),h=c.call("malloc",Y),m=c.call("malloc",Y),P=c.call("ks_asm",this.handle,R,BigInt(M),K,h,m);try{if(P!==G)throw new Error(`Failed to assemble, error: ${c.strError(this.errNo())}`);const N=d.getValue(K,"*"),I=d.getValue(h,"i32"),U=d.HEAPU8.slice(N,N+I);return c.call("ks_free",N),U}finally{c.call("free",K),c.call("free",h),c.call("free",m)}}errNo(){return c.call("ks_errno",this.handle)}static call(R,...n){const M=Rn[R];return d.ccall(R,M.returnType,M.argTypes,n)}static version(){const R=this.call("ks_version");return{major:R>>8,minor:R&255}}static archSupported(R){return this.call("ks_arch_supported",R)}static strError(R){return this.call("ks_strerror",R)}constructor(R,n){this.arch=R,this.mode=n,this.handle_ptr=c.call("malloc",Y);const M=c.call("ks_open",R,n,this.handle_ptr);if(M!==G)throw new Error(`Failed to initialize keystone: ${c.strError(M)}`)}}async function En(L){d||(d=await mr(L))}export{c as K,cn as _,En as f};
